(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{612:function(n,e,t){"use strict";t.r(e);var s=t(3),r=Object(s.a)({},(function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[t("h2",{attrs:{id:"如何理解正向代理和反向代理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如何理解正向代理和反向代理"}},[n._v("#")]),n._v(" 如何理解正向代理和反向代理")]),n._v(" "),t("ol",[t("li",[t("p",[n._v("正向代理\n客户端发送请求到代理服务器,由"),t("strong",[n._v("代理服务器为客户端发送请求到网络资源服务器")]),n._v(",将响应返回客户端")]),n._v(" "),t("p",[n._v("因此,客户端需要知道代理服务器的地址,并且"),t("strong",[n._v("需要客户端主动设置代理服务器")])]),n._v(" "),t("p",[n._v("其中, 正向代理")]),n._v(" "),t("ul",[t("li",[t("strong",[n._v("可以向网络资源服务器 隐藏客户端真实的 ip 地址")]),n._v(";")]),n._v(" "),t("li",[t("strong",[n._v("可以缓存客户端请求的响应,以便下次请求时快速返回结果")])])]),n._v(" "),t("p",[n._v("举例:VPN")])]),n._v(" "),t("li",[t("p",[n._v("反向代理\n客户端发送请求,代理服务器接收客户端的请求,"),t("strong",[n._v("按照一定的规则(SSL 指定端口)转发")]),n._v("到对应的网络资源服务器上,将响应返回客户端.")]),n._v(" "),t("p",[n._v("因此"),t("strong",[n._v("反向代理不需要由客户端设置")])]),n._v(" "),t("p",[n._v("其中, 反向代理")]),n._v(" "),t("ul",[t("li",[t("strong",[n._v("可以向客户端 隐藏网络资源服务器真实的 ip 和端口")]),n._v(";")]),n._v(" "),t("li",[t("strong",[n._v("可以通过负载均衡分配请求到多个后端服务器,避免单服务器压力过大,提高系统可靠性和处理能力")])])])])]),n._v(" "),t("h2",{attrs:{id:"vpn-和代理的区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vpn-和代理的区别"}},[n._v("#")]),n._v(" VPN 和代理的区别")]),n._v(" "),t("p",[n._v("虚拟专用网络(VPN)是一种媒介，当用户连接互联网时，该媒介会"),t("strong",[n._v("加密")]),n._v("后再传输数据。虚拟专用网络通常用于保护敏感数据以及匿名浏览互联网。")]),n._v(" "),t("p",[n._v("与代理服务器相比，最大的不同就是 VPN 将所有的用户请求都"),t("strong",[n._v("加密")]),n._v("了。虚拟专用网络会将你的原始 IP 地址转换为新的 IP 地址，从而在隐藏你的真实 IP 地址时确保更高的匿名级别。它将允许访问基于地理位置限制的内容。")]),n._v(" "),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/cbuy888/article/details/82625112",target:"_blank",rel:"noopener noreferrer"}},[n._v("反向代理重定向"),t("OutboundLink")],1),n._v(" "),t("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/451825018",target:"_blank",rel:"noopener noreferrer"}},[n._v("代理"),t("OutboundLink")],1)]),n._v(" "),t("h2",{attrs:{id:"使用-nginx-proxy-manager"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-nginx-proxy-manager"}},[n._v("#")]),n._v(" 使用 nginx proxy manager")]),n._v(" "),t("ul",[t("li",[n._v("可视化创建多个二级域名")]),n._v(" "),t("li",[n._v("...")])]),n._v(" "),t("ol",[t("li",[t("p",[n._v("下载 docker")]),n._v(" "),t("p",[n._v("过程可自己查,推荐 curl 获取 sh 文件")]),n._v(" "),t("div",{staticClass:"language-linux line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("curl -fsSL https://get.docker.com -o get-docker.sh\nsudo sh get-docker.sh\n\n若出现apt报错,可以查看sources,删除无关下载源\n//sudo vi /etc/apt/sources.list\n")])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br"),t("span",{staticClass:"line-number"},[n._v("3")]),t("br"),t("span",{staticClass:"line-number"},[n._v("4")]),t("br"),t("span",{staticClass:"line-number"},[n._v("5")]),t("br")])])]),n._v(" "),t("li",[t("p",[n._v("下载 docker-compose")]),n._v(" "),t("div",{staticClass:"language-linux line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("apt install docker-compose -y\n")])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br")])])]),n._v(" "),t("li",[t("p",[n._v("在"),t("a",{attrs:{href:"https://nginxproxymanager.com/setup/#running-the-app",target:"_blank",rel:"noopener noreferrer"}},[n._v("官网"),t("OutboundLink")],1),n._v("找到 docker-compose.yml\n复制粘贴")]),n._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("version: '3.8'\nservices:\napp:\n    image: 'jc21/nginx-proxy-manager:latest'\n    restart: unless-stopped\n    ports:\n    # These ports are in format <host-port>:<container-port>\n    - '80:80' # Public HTTP Port\n    - '443:443' # Public HTTPS Port\n    - '81:81' # Admin Web Port\n    # Add any other Stream port you want to expose\n    # - '21:21' # FTP\n\n    # Uncomment the next line if you uncomment anything in the section\n    # environment:\n    # Uncomment this if you want to change the location of\n    # the SQLite DB file within the container\n    # DB_SQLITE_FILE: \"/data/database.sqlite\"\n\n    # Uncomment this if IPv6 is not enabled on your host\n    # DISABLE_IPV6: 'true'\n\n    volumes:\n    - ./data:/data\n    - ./letsencrypt:/etc/letsencrypt\n")])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br"),t("span",{staticClass:"line-number"},[n._v("3")]),t("br"),t("span",{staticClass:"line-number"},[n._v("4")]),t("br"),t("span",{staticClass:"line-number"},[n._v("5")]),t("br"),t("span",{staticClass:"line-number"},[n._v("6")]),t("br"),t("span",{staticClass:"line-number"},[n._v("7")]),t("br"),t("span",{staticClass:"line-number"},[n._v("8")]),t("br"),t("span",{staticClass:"line-number"},[n._v("9")]),t("br"),t("span",{staticClass:"line-number"},[n._v("10")]),t("br"),t("span",{staticClass:"line-number"},[n._v("11")]),t("br"),t("span",{staticClass:"line-number"},[n._v("12")]),t("br"),t("span",{staticClass:"line-number"},[n._v("13")]),t("br"),t("span",{staticClass:"line-number"},[n._v("14")]),t("br"),t("span",{staticClass:"line-number"},[n._v("15")]),t("br"),t("span",{staticClass:"line-number"},[n._v("16")]),t("br"),t("span",{staticClass:"line-number"},[n._v("17")]),t("br"),t("span",{staticClass:"line-number"},[n._v("18")]),t("br"),t("span",{staticClass:"line-number"},[n._v("19")]),t("br"),t("span",{staticClass:"line-number"},[n._v("20")]),t("br"),t("span",{staticClass:"line-number"},[n._v("21")]),t("br"),t("span",{staticClass:"line-number"},[n._v("22")]),t("br"),t("span",{staticClass:"line-number"},[n._v("23")]),t("br"),t("span",{staticClass:"line-number"},[n._v("24")]),t("br"),t("span",{staticClass:"line-number"},[n._v("25")]),t("br")])])])]),n._v(" "),t("ul",[t("li",[n._v("注意有版本问题,3.8 改成 3 即可")]),n._v(" "),t("li",[n._v("其中 "),t("code",[n._v("jc21/nginx-proxy-manager:latest")]),n._v(" 为英文版本,可以换成 "),t("code",[n._v("chishin/nginx-proxy-manager-zh")]),n._v(" 为中文版本,其它不变")])]),n._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[n._v("运行 docker-compose up -d")])]),n._v(" "),t("ul",[t("li",[n._v("注意其中 443 端口可能被占用,需要先清空:\n"),t("code",[n._v("sudo fuser -k 443/tcp")])])]),n._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[n._v("到浏览器查看是否成功部署 ip:81")])]),n._v(" "),t("ul",[t("li",[n._v("查看 ip 命令 "),t("code",[n._v("curl ifconfig.me")]),n._v("\n记得开放 81 端口")])]),n._v(" "),t("ol",{attrs:{start:"6"}},[t("li",[t("p",[n._v("按照官网账号密码登录")]),n._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("admin@example.com\nchangeme\n")])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br")])]),t("p",[n._v("修改密码 邮箱")])]),n._v(" "),t("li",[t("p",[n._v("配置反向代理")]),n._v(" "),t("p",[n._v("client --\x3e[80 443 81] nginx 代理--\x3e server")])])]),n._v(" "),t("p",[n._v("nginx 将客户端访问端口反向代理到 server 暴露的端口")]),n._v(" "),t("ol",{attrs:{start:"8"}},[t("li",[n._v("配置二级域名")])]),n._v(" "),t("ul",[t("li",[t("p",[n._v("在仪表盘新增代理服务")]),n._v(" "),t("ul",[t("li",[t("p",[n._v("配置二级域名 (记得在云服务器上配置 dns 解析)")])]),n._v(" "),t("li",[t("p",[n._v("阻止常见漏洞可以 ✔")])]),n._v(" "),t("li",[t("p",[n._v("证书最好不要在上面设置,不然不方便管理,每一个二级域名都需要手动设置")])]),n._v(" "),t("li",[t("p",[n._v("申请 SSL 证书")]),n._v(" "),t("ul",[t("li",[n._v("域名写:主域名(不是二级域名)和*.域名(最好都写!!!);")]),n._v(" "),t("li",[n._v("使用 DNS 认证 ✔")]),n._v(" "),t("li",[t("strong",[n._v("腾讯云是在 DNSPod 申请 id,key")])])])]),n._v(" "),t("li",[t("p",[n._v("坑!! 提交后报错 Internal Error,An unexpected error occurred:\nModuleNotFoundError: No module named 'zope'\n需要进入 docker,然后下载 zope")]),n._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("docker exec -it <container> /bin/bash\npip install zope\n")])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br")])])])])])]),n._v(" "),t("h3",{attrs:{id:"使用-nginx-反向代理-内网-docker0-ip"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-nginx-反向代理-内网-docker0-ip"}},[n._v("#")]),n._v(" 使用 nginx 反向代理 内网 docker0 ip")]),n._v(" "),t("ul",[t("li",[t("code",[n._v("docker run -d -p 8099:80 --name nginx1 nginx")]),n._v("新开一个容器拉取 nginx 镜像")])]),n._v(" "),t("ul",[t("li",[t("code",[n._v("ip addr show docker0")]),n._v("查看 docker ip 172.17.0.1\n???不行,待解决\n"),t("a",{attrs:{href:"https://blog.csdn.net/ithaibiantingsong/article/details/81386307",target:"_blank",rel:"noopener noreferrer"}},[n._v("docker 容器的网络配置"),t("OutboundLink")],1)])]),n._v(" "),t("h3",{attrs:{id:"配置-docker-内的-nginx-文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-docker-内的-nginx-文件"}},[n._v("#")]),n._v(" 配置 docker 内的 nginx 文件")]),n._v(" "),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/hnw13938056090/article/details/105782931",target:"_blank",rel:"noopener noreferrer"}},[n._v("详情"),t("OutboundLink")],1),n._v(" "),t("a",{attrs:{href:"https://blog.csdn.net/weixin_41887155/article/details/107251383",target:"_blank",rel:"noopener noreferrer"}},[n._v("优质参考"),t("OutboundLink")],1)]),n._v(" "),t("ol",[t("li",[n._v("进入 nginx 对应 docker")])]),n._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('# 清空/etc/apt/sources.list文件\n echo > /etc/apt/sources.list\n\n\necho -e "deb http://mirrors.aliyun.com/debian/ stretch main non-free contrib \\ndeb-src http://mirrors.aliyun.com/debian/ stretch main non-free contrib \\ndeb http://mirrors.aliyun.com/debian-security stretch/updates main \\ndeb-src http://mirrors.aliyun.com/debian-security stretch/updates main \\ndeb http://mirrors.aliyun.com/debian/ stretch-updates main non-free contrib \\ndeb-src http://mirrors.aliyun.com/debian/ stretch-updates main non-free contrib \\ndeb http://mirrors.aliyun.com/debian/ stretch-backports main non-free contrib \\ndeb-src http://mirrors.aliyun.com/debian/ stretch-backports main non-free contrib" > /etc/apt/sources.list\n\napt-get update\n\napt-get install vim\n')])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br"),t("span",{staticClass:"line-number"},[n._v("3")]),t("br"),t("span",{staticClass:"line-number"},[n._v("4")]),t("br"),t("span",{staticClass:"line-number"},[n._v("5")]),t("br"),t("span",{staticClass:"line-number"},[n._v("6")]),t("br"),t("span",{staticClass:"line-number"},[n._v("7")]),t("br"),t("span",{staticClass:"line-number"},[n._v("8")]),t("br"),t("span",{staticClass:"line-number"},[n._v("9")]),t("br")])]),t("ul",[t("li",[n._v("nginx 项目在 docker 里面存放的目录:")])]),n._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("日志目录 : /var/log/nginx\n配置目录 : /etc/nginx/conf.d\n主配置文件 : /etc/nginx/nginx.conf\n项目目录 : /usr/share/nginx/html nginx\n")])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br"),t("span",{staticClass:"line-number"},[n._v("3")]),t("br"),t("span",{staticClass:"line-number"},[n._v("4")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[n._v("记住对应位置,方便在本地挂载文件到 docker 内\n在宿主机创建对应的目录和文件\n挂载\n注意有一步骤尤其重要:\n拷贝容器中 nginx 所有配置文件到本地\ndocker cp 容器名:/容器目录/文件名 /宿主机目录/文件名")])]),n._v(" "),t("p",[n._v("eg:"),t("code",[n._v("docker cp 45744:/etc/nginx /data/nginx/conf")]),n._v(" "),t("a",{attrs:{href:"https://blog.csdn.net/qq_33469537/article/details/126586160",target:"_blank",rel:"noopener noreferrer"}},[n._v("参考"),t("OutboundLink")],1)]),n._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://blog.csdn.net/sxzlc/article/details/107676425",target:"_blank",rel:"noopener noreferrer"}},[n._v("docker 各种命令"),t("OutboundLink")],1)])]),n._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[n._v("替换对应html即可显示")])])])}),[],!1,null,null,null);e.default=r.exports}}]);